<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Weight Tracker</title>
  <style>
    body { font-family: Arial; background: #f2f2f2; padding: 20px; }
    .card { max-width: 500px; margin: auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    input, button { width: 100%; padding: 10px; margin-top: 10px; }
    .entry { background: #f9f9f9; margin-top: 10px; padding: 10px; border-left: 4px solid #007bff; }
  </style>
</head>
<body>
  <div class="card">
    <h2>Weight Tracker</h2>
    <input type="number" id="height" placeholder="Height (cm)" />
    <input type="number" id="weight" placeholder="Weight (kg)" />
    <label><input type="checkbox" id="exercise" /> Did you exercise today?</label>
    <button onclick="submitEntry()">Submit Entry</button>
    <div id="log"></div>
  </div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js"></script>

  <script>
    // TODO: Replace below with your own Firebase config
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "your-project.firebaseapp.com",
      databaseURL: "https://your-project.firebaseio.com",
      projectId: "your-project-id",
      storageBucket: "your-project.appspot.com",
      messagingSenderId: "your-sender-id",
      appId: "your-app-id"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const auth = firebase.auth();

    let uid = null;

    auth.signInAnonymously().then(() => {
      uid = auth.currentUser.uid;
      loadEntries();
    });

    function submitEntry() {
      const weight = parseFloat(document.getElementById("weight").value);
      const height = parseFloat(document.getElementById("height").value);
      const exercised = document.getElementById("exercise").checked;

      if (!weight || !height) {
        alert("Please enter weight and height!");
        return;
      }

      const bmi = (weight / ((height / 100) ** 2)).toFixed(1);
      const entry = {
        date: new Date().toISOString().split("T")[0],
        weight,
        height,
        bmi,
        exercised
      };

      db.ref("users/" + uid + "/entries").push(entry).then(() => {
        loadEntries();
        document.getElementById("weight").value = "";
        document.getElementById("exercise").checked = false;
      });
    }

    function loadEntries() {
      db.ref("users/" + uid + "/entries").once("value").then(snapshot => {
        const data = snapshot.val();
        const log = document.getElementById("log");
        log.innerHTML = "<h3>Log:</h3>";

        if (!data) return;

        Object.values(data).reverse().forEach(entry => {
          log.innerHTML += `
            <div class="entry">
              <strong>${entry.date}</strong><br/>
              Weight: ${entry.weight} kg<br/>
              Height: ${entry.height} cm<br/>
              BMI: ${entry.bmi}<br/>
              Exercise: ${entry.exercised ? "✅" : "❌"}
            </div>
          `;
        });
      });
    }
  </script>
</body>
</html>
